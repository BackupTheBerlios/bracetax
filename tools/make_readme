#! /bin/sh

mkdir -p gendoc

cp `find /usr/share -name "*.png" | head -n 1` gendoc/found_image.png

gvim -f -R README.brtx -c 'colorscheme desert' -c 'source tools/bracetax_syntax.vim' -c TOhtml -c 'w!' -c qa

mv README.brtx.html gendoc/
cp README.brtx gendoc/

bracetax -i README.brtx -o gendoc/README_raw.html -doc
bracetax -i README.brtx -o gendoc/README_css.html -doc -link-stylesheet basic.css 
cp test/basic.css gendoc/

gvim -f -R tools/make_readme -c 'colorscheme murphy' -c 'sy on' -c TOhtml -c 'w!' -c qa
mv tools/make_readme.html gendoc/

bracetax -doc -latex -i README.brtx -o gendoc/README_latex.tex
cd gendoc
pdflatex README_latex && pdflatex README_latex
cd ..

echo "
{header|
    {title|Bracetax's README}
    {authors|{link http://sebmdt.googlepages.com|Sebastien Mondet}}
    {subtitle|Generated by {t|make_readme}}
}
Here we have:
{begin list}
    {item} The {link README.brtx|source} ({t|README.brtx})
    {item} The {link README_raw.html|generated HTML}
    {item} The {link README_css.html|generated HTML with a CSS}
    {item} The {link README_latex.pdf|generated PDF from LaTeX export}
    {item} The {link README.brtx.html|coloured source} (by Vim, c.f. 
        {link README_css.html#sec_tools|Tools})
    {item} The {link make_readme.html|script} that generated this page
{end}
" | bracetax -o gendoc/index.html -doc


